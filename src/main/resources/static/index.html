<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
  <h2>Home</h2>
  <div><a href="http://localhost:9090/hello.html">hello.html</a></div>
  <div><a href="/hello.html">hello.html</a></div>
  <div><a href="/hi">Greetings</a></div>
  <div><a href="/hi2">원영님 반갑습니다</a></div>
  <div><a href="/hi3">반갑습니다(bootstrap)</a></div>
  <div><a href="/hi4">반갑습니다(include)</a></div>
  <div>&nbsp;</div>
  <div>&nbsp;</div>
  <div><a href="/articles/WriteForm">새 글쓰기</a></div>
  <div><a href="/articles/1">1번 글 조회</a></div>
  <div><a href="/articles/List">글 목록 조회</a></div>
  <div>&nbsp;</div>
  <div><a href="/apitest.html">API test</a></div>
  <div>&nbsp;</div>
  <div><a href="/RestExam">Rest Api Get</a></div>
  <div>
    <form action="/RestExam" method="get">
      <input type="submit" value="GET" />
    </form>
  </div>
  <div>
    <form action="/RestExam" method="post">
      <input type="submit" value="POST" />
    </form>
  </div>
  <div>
    <form action="/RestExam" method="put">
      <input type="submit" value="PUT" />
    </form>
  </div>
  <div>
    <form action="/RestExam" method="DELETE">
      <input type="submit" value="DELETE" >
    </form>
  </div>
  
  <div>&nbsp;</div>
  <div><a href="/h2-console">db 확인</a></div>
  
  <!-- method 자리에는 GET, POST만 올 수 있다, 이외의 것이 오면 틀린것으로 인지한다 -->
  <script>
  
  /*
    // form 안의 <input type="submit" />
    //           <input type="image" />
    //           <button></button>
    // 모두 form의 submit 이벤트를 발생시킨다
    // submit 이벤트 form action 의 페이지로 이동
    //    form name 속성을 가진 input 등의 value 를 가지고 간다
    const formEls = document.querySelectorAll('form'); // 3개
    formEls.forEach((form) => {
    	form.onsubmit = function(e){
    	    e.preventDefault(); // 이벤트 취소시킨다 - 페이지 이동이 되지 않음
    	    // this : 현재 이벤트(submit) 발생된 객체
    	    //      : 현재 submit 된 form tag
    		fetch(this.action, {
    			//method : 'GET'
    			method : this.method
    		})
    	      .then((response) => response.text())
    	      .then(text => alert(text))
    		//=fetch('/RestExam')
    		alert(this.method);
    		alert(this.action);
    	}
    })
    */
    
    const formEls = document.querySelectorAll('form');
    console.dir(formEls);
    formEls.forEach( (form, i) => {
    	// form == formEls[i] == this
    	// (form, i)을 적으면 form 이라고 적어도 되고
    	// 아무것도 안적으면 this라고 적으면 됨
    	
    	form.addEventListener('submit',function(e){
    		// submit event 의 기본기능을 중지
    		// function(e)의 e는 기본 이벤트의 정보를 나타냄
    		
    		e.preventDefault();
    		// console.dir(this) // 객체방식으로 보여줌
    		// console.log(this) 태그로 보여줌
    		// console.dir(e.target) // this 와 e.target은 동일하다
    		console.dir(e) // submitEvent
    		alert(e.submitter.value)
    		fetch(this.action, {
    			// method:'PUT'
    			method:e.submitter.value
    		})
    		.then((response)  => response.text())
    		.then((text)  => {
    			console.dir(text)
    			alert(text)
    			})
    		.catch((error) => {
    			console.dir(error)
    			alert(error)
    			})
    	})
    	
    });
  </script>
</body>
</html>